<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6. Synchronisation - Lernportal Betriebssysteme</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Zilla+Slab:wght@700&display=swap" rel="stylesheet">
    <style>
        .page-nav { background-color: #f8f9fa; padding: 10px 0; border-bottom: 1px solid var(--border-color); font-family: var(--header-font); }
        .page-nav a { color: var(--primary-color); text-decoration: none; font-weight: bold; }
        .page-nav a:hover { text-decoration: underline; }
        .content-section h3 { font-family: var(--title-font); font-size: 1.8rem; color: #444; margin-top: 40px; margin-bottom: 20px; }
        .content-section h4 { font-family: var(--title-font); font-size: 1.4rem; color: var(--primary-color); margin-top: 30px; }
        blockquote { border-left: 4px solid var(--primary-color); padding-left: 20px; margin: 20px 0; font-style: italic; background-color: var(--secondary-color); padding: 15px 20px; border-radius: 0 5px 5px 0; }
        .image-placeholder { background-color: #f0f0f0; border: 1px dashed #ccc; padding: 20px; text-align: center; margin: 20px auto; border-radius: 5px; color: #888; max-width: 80%; display: block; font-family: var(--header-font); }
        code, pre { font-family: Consolas, 'Courier New', monospace; background-color: #f5f5f5; border: 1px solid #ddd; border-radius: 4px; }
        code { padding: 2px 5px; }
        pre { padding: 15px; overflow-x: auto; white-space: pre-wrap; font-size: 0.9em; }
        .key-term { font-weight: bold; color: var(--primary-color); }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid var(--border-color); padding: 12px; text-align: left; }
        th { background-color: var(--secondary-color); font-family: var(--header-font); }
        .problem-box { border: 2px solid #c7254e; padding: 20px; border-radius: 5px; background-color: #f9e2e8; margin-top: 20px; }
        .solution-box { border: 2px solid #28a745; padding: 20px; border-radius: 5px; background-color: #eaf6ec; margin-top: 20px; }
    </style>
</head>
<body>

    <nav class="site-nav">
        <div class="container">
        <button class="nav-toggle" aria-label="Menü umschalten">&#9776;</button>
            <a href="index.html">Zurück zur Übersicht</a>
            <a href="01_einfuehrung.html">1</a>
            <a href="02_grundlagen.html">2</a>
            <a href="03_prozesse.html">3</a>
            <a href="04_threads.html">4</a>
            <a href="05_scheduling.html">5</a>
            <a href="06_synchronisation.html" class="active">6</a>
            <a href="07_kommunikation.html">7</a>
            <a href="08_deadlocks.html">8</a>
            <a href="09_speicherverwaltung.html">9</a>
            <a href="10_dateisysteme.html">10</a>
        </div>
    </nav>
    <header>
        <div class="container">
            <h1>Kapitel 6: Synchronisation</h1>
            <p>Die Beherrschung des kontrollierten Chaos von nebenläufigen Prozessen und Threads.</p>
        </div>
    </header>
    <main class="container">
        <article class="content-section">
            <h2>Das Problem der Nebenläufigkeit</h2>
            <p>Betriebssysteme ermöglichen die <span class="key-term">nebenläufige</span> Ausführung von Prozessen und Threads. Dies führt zu einem <span class="key-term">Indeterminismus</span>: Die relative Ausführungsreihenfolge ist nicht vorhersagbar.</p>
            <p>Problematisch, wenn:</p>
            <ul>
                <li>Gemeinsame Betriebsmittel (z.B. Drucker) genutzt werden.</li>
                <li>Gemeinsame Daten (z.B. globale Variablen) bearbeitet werden.</li>
                <li>Prozesse kooperieren müssen.</li>
            </ul>
            <div class="problem-box">
                <h4>Wettlaufsituation (Race Condition)</h4>
                <p>Wenn mehrere Threads auf dieselben Daten zugreifen, kann das Endergebnis von der unvorhersehbaren Ausführungsreihenfolge abhängen.</p>
                <div class="image-placeholder">[Diagramm: Homebanking-Transaktionen mit falschem Kontostand]</div>
            </div>
            <h3>Kritischer Abschnitt und Wechselseitiger Ausschluss</h3>
            <p><span class="key-term">Mutual Exclusion</span> stellt sicher, dass nur ein Thread zur Zeit im kritischen Abschnitt ist.</p>
            <h2>Lösungsansätze</h2>
            <h4>1. Interrupts sperren</h4>
            <p>Sperren von Interrupts verhindert Kontextwechsel, eignet sich nur für Einprozessor-Systeme.</p>
            <h4>2. Software mit Busy Waiting</h4>
            <p>Aktives Warten verschwendet CPU-Zyklen; Beispiele: einfache Lock-Variable, Peterson-Algorithmus.</p>
            <h4>3. Hardware-Unterstützung</h4>
            <p>Atomare Befehle wie <code>test_and_set()</code> ermöglichen unteilbares Testen und Setzen.</p>
            <h2>Semaphore</h2>
            <p>Synchronisationsvariable mit atomaren Operationen <code>Wait()</code> und <code>Signal()</code>. Threads werden blockiert statt busy waiting.</p>
            <p><strong>Binärer Semaphor:</strong> Werte 0 oder 1 als Mutex.</p>
            <div class="solution-box">
                <h4>Beispiel Java-Semaphor</h4>
                <pre>
import java.util.concurrent.Semaphore;

static Semaphore mutex = new Semaphore(1);

mutex.acquire(); // Eintritt
// kritischer Abschnitt
mutex.release(); // Austritt
                </pre>
            </div>
            <h2>Monitore</h2>
            <p>Objektorientierte Synchronisation: Methoden sind automatisch wechselseitig ausgeschlossen.</p>
            <h4>Bedingungsvariablen</h4>
            <p><code>wait()</code> und <code>notify()/notifyAll()</code> ermöglichen das Warten und Wecken innerhalb eines Monitors.</p>
            <div class="solution-box">
                <h4>Beispiel Java-Monitor</h4>
                <pre>
public synchronized void transfer(int amount) {
    while(buffer.empty()) wait();
    // Verarbeitung
    notifyAll();
}
                </pre>
            </div>
            <h2>Klassische Probleme</h2>
            <h4>Erzeuger-Verbraucher</h4>
            <p>Semaphor- und Monitor-Lösungen für Pufferzugriff und Synchronisation.</p>
            <h4>Leser-Schreiber</h4>
            <p>Gleichzeitiges Lesen, exklusives Schreiben mit Zähler und Semaphoren.</p>
            <h4>Barriere / Rendezvous</h4>
            <p>N Threads warten aufeinander, bevor alle fortfahren. Lösung mit Zähler, Mutex und Semaphor.</p>
            <h2>Generelle Semaphore</h2>
            <p>Semaphor-Variable kann Werte von -M bis +N annehmen:</p>
            <ul>
                <li><code>Wait(S):</code> S--, wenn S<0 → Blockierung.</li>
                <li><code>Signal(S):</code> S++, wenn S<=0 → ein Thread wird deblockiert.</li>
            </ul>
            <h2>Synchronisationsdienste in UNIX/Linux</h2>
            <h4>POSIX-Thread-Mutex</h4>
            <pre>
#include <pthread.h>

pthread_mutex_t my_mutex = PTHREAD_MUTEX_INITIALIZER;

pthread_mutex_lock(&my_mutex);
// kritischer Abschnitt
pthread_mutex_unlock(&my_mutex);
            </pre>
            <h4>System-V-Semaphoren</h4>
            <pre>
int semid = semget(key, 1, IPC_CREAT | 0666);
semctl(semid, 0, SETVAL, initialValue);

// Wait
struct sembuf op = {0, -1, 0};
semop(semid, &op, 1);
// Signal
op.sem_op = +1;
semop(semid, &op, 1);
            </pre>
            <h2>Synchronisationsdienste in Windows</h2>
            <h4>Kritische Abschnitte</h4>
            <pre>
CRITICAL_SECTION cs;
InitializeCriticalSection(&cs);
EnterCriticalSection(&cs);
// kritischer Abschnitt
LeaveCriticalSection(&cs);
            </pre>
            <h4>Mutex und Semaphore</h4>
            <pre>
HANDLE hMutex = CreateMutex(NULL, FALSE, NULL);
WaitForSingleObject(hMutex, INFINITE);
ReleaseMutex(hMutex);

HANDLE hSem = CreateSemaphore(NULL, initialCount, maxCount, NULL);
WaitForSingleObject(hSem, INFINITE);
ReleaseSemaphore(hSem, 1, NULL);
            </pre>
        </article>
    </main>
    <footer>
        <div class="container">
            <p>Erstellt zur Unterstützung der Prüfungsvorbereitung. Viel Erfolg bei der Klausur!</p>
        </div>
    </footer>
    <script src="js/main.js"></script>
</body>
</html>
